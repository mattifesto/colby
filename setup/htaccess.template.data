#
# Explicitly disallow directory listings.
#

Options -Indexes

<IfModule mod_rewrite.c>

RewriteEngine On
RewriteBase /


#
# Redirect to https
#

RewriteCond %{HTTPS} off
RewriteRule (.*) https://%{SERVER_NAME}/$1 [R=301,L]


#
# Pass URLS matching the following patterns through without any further
# modification
#

RewriteRule ^index\.php$ - [L]


#
# If the URL doesn't reference an existing file then rewrite to /index.php
#

RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule . /index.php [L]


#
# If the request is for an existing data file rewrite to `index.php` to
# deny access to the file. Data files are used to hold private site data
# that should only be provided to the user if necessary via a handler.
#

RewriteRule \.data$ /index.php [L]
RewriteRule \.json$ /index.php [L]


#
# If the request is for an existing file whose path contains the string '.git'
# rewrite to index.php (do not show the file)
#

RewriteRule \.git /index.php [L]


#
# If the request is for an existing file in the `/tmp` directory rewrite to
# index.php (do not show the file)
#

RewriteRule ^tmp/ /index.php [L]


#
# If the request is for an existing php file (other than index.php) rewrite to
# index.php (do not show the file)
#

RewriteRule \.php$ /index.php [L]

</IfModule>
